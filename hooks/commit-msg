#!/usr/bin/env node

// Conventional commit message hook
// Enforces: lowercase, â‰¤40 chars first line, starts with type: like feat:, fix:, etc.

import { validateCommitMessage } from '../lib/commit-msg-enforcer.mjs';
import { readFileSync } from 'fs';

const commitMsgFile = process.argv[2];
const commitMsg = readFileSync(commitMsgFile, 'utf8').split('\n')[0];

const errors = validateCommitMessage(commitMsg);

if (errors.length > 0) {
  console.error('Commit message validation failed:');
  errors.forEach(e => console.error(`- ${e}`));
  process.exit(1);
}

console.log('Commit message is valid');